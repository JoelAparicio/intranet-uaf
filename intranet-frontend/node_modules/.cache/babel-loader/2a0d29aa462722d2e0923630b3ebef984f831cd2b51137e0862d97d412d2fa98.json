{"ast":null,"code":"import axios from 'axios';\nimport { Modal } from 'bootstrap';\nimport Swal from 'sweetalert2';\nexport default {\n  data() {\n    return {\n      user: {\n        nombre: '',\n        correo_electronico: '',\n        cargo: '',\n        posicion: '',\n        cedula: '',\n        extension: '',\n        estado: '',\n        departamento: '',\n        horas_extra: '',\n        firma_path: null\n      },\n      editUser: {\n        nombre: '',\n        cargo: '',\n        posicion: '',\n        extension: ''\n      },\n      firmaFile: null,\n      editModalInstance: null\n    };\n  },\n  created() {\n    this.fetchUserData();\n  },\n  methods: {\n    async fetchUserData() {\n      try {\n        const token = localStorage.getItem('auth_token');\n        const response = await axios.get('http://localhost:8080/api/user', {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        this.user = response.data.data;\n        this.editUser = {\n          ...this.user\n        };\n        this.$nextTick(() => {\n          this.editModalInstance = new Modal(document.getElementById('editModal'));\n        });\n      } catch (error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: 'Error al cargar sus datos'\n        });\n        console.error('Error al cargar sus datos', error);\n      }\n    },\n    async updateUserData() {\n      try {\n        const token = localStorage.getItem('auth_token');\n        await axios.put('http://localhost:8080/api/edit_user', this.editUser, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        this.user = {\n          ...this.editUser\n        };\n        this.editModalInstance.hide();\n        Swal.fire({\n          icon: 'success',\n          title: 'Actualizado',\n          text: 'Datos actualizados correctamente',\n          timer: 1000,\n          showConfirmButton: false\n        }).then(() => {\n          location.reload();\n        });\n      } catch (error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Error',\n          text: 'Ha ocurrido un error al actualizar los datos'\n        });\n        console.error('Ha ocurrido un error al actualizar los datos', error);\n      }\n    },\n    handleFirmaFile(e) {\n      this.firmaFile = e.target.files[0];\n    },\n    async uploadFirma() {\n      if (!this.firmaFile) return;\n      const formData = new FormData();\n      formData.append('firma', this.firmaFile);\n      try {\n        const token = localStorage.getItem('auth_token');\n        await axios.post('http://localhost:8080/api/upload-firma', formData, {\n          headers: {\n            'Authorization': `Bearer ${token}`,\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        Swal.fire({\n          icon: 'success',\n          title: 'Firma registrada',\n          timer: 1500,\n          showConfirmButton: false\n        });\n        this.fetchUserData();\n        const modal = Modal.getInstance(document.getElementById('firmaModal'));\n        modal.hide();\n      } catch (error) {\n        Swal.fire({\n          icon: 'error',\n          title: 'Error al subir la firma'\n        });\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","Modal","Swal","data","user","nombre","correo_electronico","cargo","posicion","cedula","extension","estado","departamento","horas_extra","firma_path","editUser","firmaFile","editModalInstance","created","fetchUserData","methods","token","localStorage","getItem","response","get","headers","$nextTick","document","getElementById","error","fire","icon","title","text","console","updateUserData","put","hide","timer","showConfirmButton","then","location","reload","handleFirmaFile","e","target","files","uploadFirma","formData","FormData","append","post","modal","getInstance"],"sources":["C:\\laragon\\www\\intranet-frontend\\src\\components\\Datos_Usuario.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"col-md-12\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header d-flex justify-content-between\">\r\n          <h5 class=\"mb-3\">Datos personales</h5>\r\n          <div>\r\n            <button\r\n                type=\"button\"\r\n                class=\"btn btn-primary\"\r\n                data-bs-toggle=\"modal\"\r\n                data-bs-target=\"#editModal\"\r\n            >Editar</button>\r\n            <button\r\n                v-if=\"!user.firma_path\"\r\n                type=\"button\"\r\n                class=\"btn btn-outline-success ms-2\"\r\n                data-bs-toggle=\"modal\"\r\n                data-bs-target=\"#firmaModal\"\r\n            >Registrar firma</button>\r\n          </div>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          <p class=\"card-text\">Aquí podrás ver tus datos personales como colaborador de la UAF</p>\r\n          <form class=\"pb-5 pt-4\">\r\n            <div class=\"row\">\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"nombre\" class=\"form-label\">Nombre</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"nombre\" v-model=\"user.nombre\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"correo_electronico\" class=\"form-label\">Correo Electrónico</label>\r\n                <input type=\"email\" class=\"form-control\" id=\"correo_electronico\" v-model=\"user.correo_electronico\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"cargo\" class=\"form-label\">Cargo</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"cargo\" v-model=\"user.cargo\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"posicion\" class=\"form-label\">Posición</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"posicion\" v-model=\"user.posicion\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"cedula\" class=\"form-label\">Cédula</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"cedula\" v-model=\"user.cedula\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"extension\" class=\"form-label\">Extensión</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"extension\" v-model=\"user.extension\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"estado\" class=\"form-label\">Estado</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"estado\" v-model=\"user.estado\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"departamento\" class=\"form-label\">Departamento</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"departamento\" v-model=\"user.departamento\" disabled>\r\n              </div>\r\n              <div class=\"col-md-4 mb-3\">\r\n                <label for=\"horas_extra\" class=\"form-label\">Horas extra</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"horas_extra\" v-model=\"user.tiempo_extra\" disabled>\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Modal editar usuario -->\r\n    <div class=\"modal fade\" id=\"editModal\" tabindex=\"-1\" aria-labelledby=\"editModalLabel\" aria-hidden=\"true\">\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <div class=\"modal-header\">\r\n            <h5 class=\"modal-title\" id=\"editModalLabel\">Editar Datos Personales</h5>\r\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n          </div>\r\n          <div class=\"modal-body\">\r\n            <form @submit.prevent=\"updateUserData\">\r\n              <div class=\"mb-3\">\r\n                <label for=\"editNombre\" class=\"form-label\">Nombre</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"editNombre\" v-model=\"editUser.nombre\">\r\n              </div>\r\n              <div class=\"mb-3\">\r\n                <label for=\"editCargo\" class=\"form-label\">Cargo</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"editCargo\" v-model=\"editUser.cargo\">\r\n              </div>\r\n              <div class=\"mb-3\">\r\n                <label for=\"editPosicion\" class=\"form-label\">Posición</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"editPosicion\" v-model=\"editUser.posicion\">\r\n              </div>\r\n              <div class=\"mb-3\">\r\n                <label for=\"editExtension\" class=\"form-label\">Extensión</label>\r\n                <input type=\"text\" class=\"form-control\" id=\"editExtension\" v-model=\"editUser.extension\">\r\n              </div>\r\n              <button type=\"submit\" class=\"btn btn-primary\">Guardar cambios</button>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Modal subir firma -->\r\n    <div class=\"modal fade\" id=\"firmaModal\" tabindex=\"-1\" aria-labelledby=\"firmaModalLabel\" aria-hidden=\"true\">\r\n      <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n          <form @submit.prevent=\"uploadFirma\">\r\n            <div class=\"modal-header\">\r\n              <h5 class=\"modal-title\">Subir Firma</h5>\r\n              <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n              <input type=\"file\" class=\"form-control\" accept=\"image/png,image/jpeg,image/jpg\" @change=\"handleFirmaFile\" required />\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n              <button type=\"submit\" class=\"btn btn-success\">Subir Firma</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport { Modal } from 'bootstrap'\r\nimport Swal from 'sweetalert2'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      user: {\r\n        nombre: '',\r\n        correo_electronico: '',\r\n        cargo: '',\r\n        posicion: '',\r\n        cedula: '',\r\n        extension: '',\r\n        estado: '',\r\n        departamento: '',\r\n        horas_extra: '',\r\n        firma_path: null\r\n      },\r\n      editUser: {\r\n        nombre: '',\r\n        cargo: '',\r\n        posicion: '',\r\n        extension: ''\r\n      },\r\n      firmaFile: null,\r\n      editModalInstance: null\r\n    }\r\n  },\r\n  created() {\r\n    this.fetchUserData()\r\n  },\r\n  methods: {\r\n    async fetchUserData() {\r\n      try {\r\n        const token = localStorage.getItem('auth_token')\r\n        const response = await axios.get('http://localhost:8080/api/user', {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        })\r\n        this.user = response.data.data\r\n        this.editUser = { ...this.user }\r\n        this.$nextTick(() => {\r\n          this.editModalInstance = new Modal(document.getElementById('editModal'))\r\n        })\r\n      } catch (error) {\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Error',\r\n          text: 'Error al cargar sus datos'\r\n        })\r\n        console.error('Error al cargar sus datos', error)\r\n      }\r\n    },\r\n    async updateUserData() {\r\n      try {\r\n        const token = localStorage.getItem('auth_token')\r\n        await axios.put('http://localhost:8080/api/edit_user', this.editUser, {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`\r\n          }\r\n        })\r\n        this.user = { ...this.editUser }\r\n        this.editModalInstance.hide()\r\n        Swal.fire({\r\n          icon: 'success',\r\n          title: 'Actualizado',\r\n          text: 'Datos actualizados correctamente',\r\n          timer: 1000,\r\n          showConfirmButton: false\r\n        }).then(() => {\r\n          location.reload()\r\n        })\r\n      } catch (error) {\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Error',\r\n          text: 'Ha ocurrido un error al actualizar los datos'\r\n        })\r\n        console.error('Ha ocurrido un error al actualizar los datos', error)\r\n      }\r\n    },\r\n    handleFirmaFile(e) {\r\n      this.firmaFile = e.target.files[0];\r\n    },\r\n    async uploadFirma() {\r\n      if (!this.firmaFile) return;\r\n\r\n      const formData = new FormData();\r\n      formData.append('firma', this.firmaFile);\r\n\r\n      try {\r\n        const token = localStorage.getItem('auth_token');\r\n        await axios.post('http://localhost:8080/api/upload-firma', formData, {\r\n          headers: {\r\n            'Authorization': `Bearer ${token}`,\r\n            'Content-Type': 'multipart/form-data'\r\n          }\r\n        });\r\n\r\n        Swal.fire({\r\n          icon: 'success',\r\n          title: 'Firma registrada',\r\n          timer: 1500,\r\n          showConfirmButton: false\r\n        });\r\n\r\n        this.fetchUserData();\r\n        const modal = Modal.getInstance(document.getElementById('firmaModal'));\r\n        modal.hide();\r\n      } catch (error) {\r\n        Swal.fire({\r\n          icon: 'error',\r\n          title: 'Error al subir la firma'\r\n        });\r\n        console.error(error);\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}